# 概要

バーチャルキャストには[ホワイトボード](https://virtualcast.jp/wiki/virtualcast/studio/item/whiteboard)というものがあって、それに登録することで中で便利に画像を表示したり線を書き込んだりしてプレゼンをしたり出来る機能があります。
バーチャルキャスト内では比較的よく使われると思われる機能で以下のような特徴があります。

* http/httpsで直接アクセス出来る公開された画像が必要<br>
直接アクセスが必要で、リダイレクトされるものは使うことが出来ません。なのでGoogle Photoの共有リンクではだめでその先の画像のURLが必要です。
* URLをカンマ区切りで指定すれば複数の画像を登録して切り替えて表示できる<br>
こんな感じのCSVを用意する必要があります。<br>
```
"https://hoge.com/hoge01.jpg".
"https://hoge.com/hoge02.jpg".
"https://hoge.com/hoge03.jpg"
```

## ホワイトボード準備の際に出る問題

ホワイトボードの用意をする際に何点か気にする点があります。

1. 複数の画像の用意
1. 画像の配布先の確保
1. 画像URLの連番CSVの作成

これについて1点づつ記載してきます。

### 複数の画像の用意

色々な方法がありますがとりあえずLibraOfficeで作成する方法を記載します。

1. LibraOffce impress というツールを使ってプレゼンを作ります。
2. スライドを全選択して「ファイル」＞「エクスポート」を選んで、出力形式を「HTML」にして出力します。
こうするとHTMLの構成ファイルの一部としてプレゼンの連番画像が得られます。
![画像]

### 画像の配布先の確保

http/httpsで公開できれば良いので有名所だと以下のような場所があるとおもいます。

1. DropBoxにて公開してURLを取得
2. Google Driveにて公開してURLを取得
3. discordで公開してURLを取得

Twitterの画像を公開されている場合もありますがGoogle Photoと同様に直接URLが取れないので今回は避けます。

今回は内部の連絡や緊急時の音声チャットなどでもよく使われるDidcordに公開する前提で考えます。

#### Discordにて公開

Discordで自分用のサーバを設定します。そこに専用のテキストチャンネルを作成して、画像をアップロードしてください。
![画像]

### 画像URLの連番CSV作成

バーチャルキャストのホワイトボードに使うため、先にテキストチャンネルにアップロードした画像のURLをCSVにしたものを作る必要があります。<br>
皆さんCSVの作成に苦労されるようです。自分でWebサーバを持っている方だったら公開URL名も規則性を持たせる事も出来ますがDiscordなどの外部サービスだと難しいと思います。

今回は、なにか外部のアプリを用意することは避けてブラウザとエディタで完結するように考えてみました。

1. Bookmarkletを作成します。
    1. 空ページのブックマークを作成します。
    1. 作成したブックマークの編集画面に移動してURLの内容を以下のBookmarkletに書き換えます。<br>このBookmarkletは1回作ったら後は使いまわします。
    ``` javascript:(function(l,d,i){for(i=0;i<l.length;i++)if (l[i].src.indexOf("attachments") > -1){tmp=l[i].src.split("?");d.write(', "'+tmp[0]+'"');}})(document.getElementsByTagName('img'),open().document); ```
1. 画像を貼り付けたテキストチャンネルを開きます。<br>一度スクロールをして画像ファイルを一通り画面に表示しておいてください。
1. 項番１で作成したブックマークを呼び出します。<br>新しくウインドウが開いて以下のようなCSVが出力されます。<br>
   ```
   , "https://media.discordapp.net/attachments/827862088399585280/827862241989754910/20210403_01.png", "https://media.discordapp.net/attachments/827862088399585280/827862265617186836/20210403_02.png", 
   (略)
   "https://media.discordapp.net/attachments/827862088399585280/827862277214568448/20210403_06.png"
   ```
1. CSVの先頭に不要なカンマ「,」があるのでそれを消してください。
   ```
   "https://media.discordapp.net/attachments/827862088399585280/827862241989754910/20210403_01.png", "https://media.discordapp.net/attachments/827862088399585280/827862265617186836/20210403_02.png", 
   (略)
   "https://media.discordapp.net/attachments/827862088399585280/827862277214568448/20210403_06.png"
   ```

### バーチャルキャストに取り込み

上記で出来上がったテキストをコピーして、バーチャルキャストの設定画面に貼り付けます。<br>
CSVをそのまま入力欄の一番上に貼り付けることで複数件登録することが出来ます。

バーチャルキャストを起動して確認してみてください。

# 最後に

バーチャルキャストは元々、ニコニコのニコナレというサービスと連携していて、用意にホワイトボード画像を作ることが出来ていたのですが、ニコナレ終了移行に難民が出る自体になっていましたｗ

なので同じニコニコのサービスであるブロマガからホワイトボード画像を調達する方向で考えていた所、2021年10月にユーザーブロマガの終了が発表されました（汗

> ニコナレ終了にてバーチャルキャストのスライドが困る件について:kou1nikoのブロマガ - ブロマガ https://ch.nicovideo.jp/kou1niko/blomaga/ar1766413 

> 「ユーザーブロマガ」サービス終了（2021年10月予定）のお知らせ https://site.nicovideo.jp/ch/userblomaga_thanks/ 

以前から複数の方から多数の画像URLを用意するのが大変だと言う話を聞いていたので書いてみました。<br>
ご参考になれば幸いです。